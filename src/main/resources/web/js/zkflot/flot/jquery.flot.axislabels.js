(function(l){var p={};function v(){return !!document.createElement("canvas").getContext}function u(){if(!v()){return false}var a=document.createElement("canvas");var b=a.getContext("2d");return typeof b.fillText=="function"}function r(){var a=document.createElement("div");return typeof a.style.MozTransition!="undefined"||typeof a.style.OTransition!="undefined"||typeof a.style.webkitTransition!="undefined"||typeof a.style.transition!="undefined"}function m(c,b,d,e,a){this.axisName=c;this.position=b;this.padding=d;this.plot=e;this.opts=a;this.width=0;this.height=0}m.prototype.cleanup=function(){};n.prototype=new m();n.prototype.constructor=n;function n(c,b,d,e,a){m.prototype.constructor.call(this,c,b,d,e,a)}n.prototype.calculateSize=function(){if(!this.opts.axisLabelFontSizePixels){this.opts.axisLabelFontSizePixels=14}if(!this.opts.axisLabelFontFamily){this.opts.axisLabelFontFamily="sans-serif"}var a=this.opts.axisLabelFontSizePixels+this.padding;var b=this.opts.axisLabelFontSizePixels+this.padding;if(this.position=="left"||this.position=="right"){this.width=this.opts.axisLabelFontSizePixels+this.padding;this.height=0}else{this.width=0;this.height=this.opts.axisLabelFontSizePixels+this.padding}};n.prototype.draw=function(e){if(!this.opts.axisLabelColour){this.opts.axisLabelColour="black"}var g=this.plot.getCanvas().getContext("2d");g.save();g.font=this.opts.axisLabelFontSizePixels+"px "+this.opts.axisLabelFontFamily;g.fillStyle=this.opts.axisLabelColour;var f=g.measureText(this.opts.axisLabel).width;var a=this.opts.axisLabelFontSizePixels;var b,c,d=0;if(this.position=="top"){b=e.left+e.width/2-f/2;c=e.top+a*0.72}else{if(this.position=="bottom"){b=e.left+e.width/2-f/2;c=e.top+e.height-a*0.72}else{if(this.position=="left"){b=e.left+a*0.72;c=e.height/2+e.top+f/2;d=-Math.PI/2}else{if(this.position=="right"){b=e.left+e.width-a*0.72;c=e.height/2+e.top-f/2;d=Math.PI/2}}}}g.translate(b,c);g.rotate(d);g.fillText(this.opts.axisLabel,0,0);g.restore()};s.prototype=new m();s.prototype.constructor=s;function s(c,b,d,e,a){m.prototype.constructor.call(this,c,b,d,e,a);this.elem=null}s.prototype.calculateSize=function(){var a=l('<div class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(a);this.labelWidth=a.outerWidth(true);this.labelHeight=a.outerHeight(true);a.remove();this.width=this.height=0;if(this.position=="left"||this.position=="right"){this.width=this.labelWidth+this.padding}else{this.height=this.labelHeight+this.padding}};s.prototype.cleanup=function(){if(this.elem){this.elem.remove()}};s.prototype.draw=function(a){this.plot.getPlaceholder().find("#"+this.axisName+"Label").remove();this.elem=l('<div id="'+this.axisName+'Label" " class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(this.elem);if(this.position=="top"){this.elem.css("left",a.left+a.width/2-this.labelWidth/2+"px");this.elem.css("top",a.top+"px")}else{if(this.position=="bottom"){this.elem.css("left",a.left+a.width/2-this.labelWidth/2+"px");this.elem.css("top",a.top+a.height-this.labelHeight+"px")}else{if(this.position=="left"){this.elem.css("top",a.top+a.height/2-this.labelHeight/2+"px");this.elem.css("left",a.left+"px")}else{if(this.position=="right"){this.elem.css("top",a.top+a.height/2-this.labelHeight/2+"px");this.elem.css("left",a.left+a.width-this.labelWidth+"px")}}}}};t.prototype=new s();t.prototype.constructor=t;function t(c,b,d,e,a){s.prototype.constructor.call(this,c,b,d,e,a)}t.prototype.calculateSize=function(){s.prototype.calculateSize.call(this);this.width=this.height=0;if(this.position=="left"||this.position=="right"){this.width=this.labelHeight+this.padding}else{this.height=this.labelHeight+this.padding}};t.prototype.transforms=function(c,h,i){var b={"-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":""};if(h!=0||i!=0){var e=" translate("+h+"px, "+i+"px)";b["-moz-transform"]+=e;b["-webkit-transform"]+=e;b["-o-transform"]+=e;b["-ms-transform"]+=e}if(c!=0){var g=c/90;var a=" rotate("+c+"deg)";b["-moz-transform"]+=a;b["-webkit-transform"]+=a;b["-o-transform"]+=a;b["-ms-transform"]+=a}var f="top: 0; left: 0; ";for(var d in b){if(b[d]){f+=d+":"+b[d]+";"}}f+=";";return f};t.prototype.calculateOffsets=function(a){var b={x:0,y:0,degrees:0};if(this.position=="bottom"){b.x=a.left+a.width/2-this.labelWidth/2;b.y=a.top+a.height-this.labelHeight}else{if(this.position=="top"){b.x=a.left+a.width/2-this.labelWidth/2;b.y=a.top}else{if(this.position=="left"){b.degrees=-90;b.x=a.left-this.labelWidth/2+this.labelHeight/2;b.y=a.height/2+a.top}else{if(this.position=="right"){b.degrees=90;b.x=a.left+a.width-this.labelWidth/2-this.labelHeight/2;b.y=a.height/2+a.top}}}}return b};t.prototype.draw=function(a){this.plot.getPlaceholder().find("."+this.axisName+"Label").remove();var b=this.calculateOffsets(a);this.elem=l('<div class="axisLabels '+this.axisName+'Label" style="position:absolute; color: '+this.opts.color+"; "+this.transforms(b.degrees,b.x,b.y)+'">'+this.opts.axisLabel+"</div>");this.plot.getPlaceholder().append(this.elem)};o.prototype=new t();o.prototype.constructor=o;function o(c,b,d,e,a){t.prototype.constructor.call(this,c,b,d,e,a);this.requiresResize=false}o.prototype.transforms=function(d,b,c){var e="";if(d!=0){var a=d/90;while(a<0){a+=4}e+=" filter: progid:DXImageTransform.Microsoft.BasicImage(rotation="+a+"); ";this.requiresResize=(this.position=="right")}if(b!=0){e+="left: "+b+"px; "}if(c!=0){e+="top: "+c+"px; "}return e};o.prototype.calculateOffsets=function(a){var b=t.prototype.calculateOffsets.call(this,a);if(this.position=="top"){b.y=a.top+1}else{if(this.position=="left"){b.x=a.left;b.y=a.height/2+a.top-this.labelWidth/2}else{if(this.position=="right"){b.x=a.left+a.width-this.labelHeight;b.y=a.height/2+a.top-this.labelWidth/2}}}return b};o.prototype.draw=function(a){t.prototype.draw.call(this,a);if(this.requiresResize){this.elem=this.plot.getPlaceholder().find("."+this.axisName+"Label");this.elem.css("width",this.labelWidth);this.elem.css("height",this.labelHeight)}};function q(d){var a=false;var b={};var c={left:0,right:0,top:0,bottom:0};var e=2;d.hooks.draw.push(function(g,h){var f=false;if(!a){l.each(g.getAxes(),function(D,A){var k=A.options||g.getOptions()[D];if(D in b){A.labelHeight=A.labelHeight-b[D].height;A.labelWidth=A.labelWidth-b[D].width;k.labelHeight=A.labelHeight;k.labelWidth=A.labelWidth;b[D].cleanup();delete b[D]}if(!k||!k.axisLabel||!A.show){return}f=true;var j=null;if(!k.axisLabelUseHtml&&navigator.appName=="Microsoft Internet Explorer"){var C=navigator.userAgent;var B=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(B.exec(C)!=null){rv=parseFloat(RegExp.$1)}if(rv>=9&&!k.axisLabelUseCanvas&&!k.axisLabelUseHtml){j=t}else{if(!k.axisLabelUseCanvas&&!k.axisLabelUseHtml){j=o}else{if(k.axisLabelUseCanvas){j=n}else{j=s}}}}else{if(k.axisLabelUseHtml||(!r()&&!u())&&!k.axisLabelUseCanvas){j=s}else{if(k.axisLabelUseCanvas||!r()){j=n}else{j=t}}}var i=k.axisLabelPadding===undefined?e:k.axisLabelPadding;b[D]=new j(D,A.position,i,g,k);b[D].calculateSize();k.labelHeight=A.labelHeight+b[D].height;k.labelWidth=A.labelWidth+b[D].width});if(f){a=true;g.setupGrid();g.draw()}}else{a=false;l.each(g.getAxes(),function(i,k){var j=k.options||g.getOptions()[i];if(!j||!j.axisLabel||!k.show){return}b[i].draw(k.box)})}})}l.plot.plugins.push({init:q,options:p,name:"axisLabels",version:"2.0"})})(jQuery);